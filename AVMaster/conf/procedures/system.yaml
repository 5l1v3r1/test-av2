
# ------------- SYSTEM COMMANDS -------------- #


SYSTEM_WINDOWS:
    - CALL: INIT_DISPATCH
    - START_AGENT
    - CALL: SET_DEFAULTS
    - BUILD: [ scout, windows, silent ]
    - BUILD: [ elite, windows, silent ]
    - BUILD: [ scout, windows, melt ]
    - STOP_AGENT

SYSTEM_STATIC:
    - VM_ALL
    - CALL: INIT_DISPATCH
    - START_AGENT
    - CROP: True
    - REPORT:
        - BUILD_DESKTOP
        - BUILD_MOBILE
        - BUILD_EXPLOIT
    - CROP: False
    - STOP_AGENT
    - STOP_VM

SYSTEM_STATIC_MOBILE:
    - VM_ALL: IMPORTANT
    - INTERNET: False
    - SLEEP: [0, 600]
    - CALL: INIT_DISPATCH
    - START_AGENT
    - CLEAN_EVIDENCES
    - CROP: True
    - REPORT:
        - BUILD_MOBILE
    - CROP: False
    - STOP_AGENT
    - STOP_VM

REVERT:
    - VM_ALL
    - INTERNET: False
    - SLEEP: [1, 10]
    - REVERT

SYSTEM_START:
    - VM_ALL
    - INTERNET: False
    - SLEEP: [1, 60]
    - START_VM

SYSTEM_DAILY:
    - VM_ALL
    #- VM: [ahnlab,avast]
    - ON_ERROR: STOP
    - SLEEP: [1, 600]
    - CALL: INIT_DISPATCH
    - CALL: VM_CLEAN_EVIDENCES
    - REPORT:
        - VM_STATIC
        - VM_ELITE_FAST
        - VM_MELT
    - UNINSTALL
    - CALL: END_DISPATCH

SYSTEM_POSITIVE:
    - VM: [360cn,adaware,ahnlab,avast,avast32,avg,avg32,avira,bitdef,comodo,drweb,eset,fsecure,gdata,kis,kis14,kis32,mbytes,mcafee,msessential,norman,norton,panda,risint,trendm,zoneal]
    #- VM: [avast,avira,eset,fsecure]
    - INTERNET: False
    - REPORT:
        - DISPATCH
        - PUSH_VIRUS

SYSTEM_FAST:
    - VM: ['360cn', 'drweb', 'fsecure', 'kis14', 'kis32', 'panda', 'zoneal']
    #- VM_ALL: important
    #- STOP_AGENT
    #- CALL: VM_PUSH_AGENT
    #- INSTALL_AGENT
    #- START_AGENT
    #- SLEEP: [1,30]
    - CALL: VM_ELITE_FAST

SYSTEM_MANUAL_CHECK:
    - VM: ['360cn', 'drweb', 'fsecure', 'kis14', 'kis32', 'panda', 'zoneal']
    - CALL: INIT_DISPATCH
    #- CALL: VM_PUSH_AGENT
    #- CALL: VM_SCOUT
    #- START_AGENT
    - CALL: SET_DEFAULTS
    - BUILD: [ pull, windows, silent ]
    - STOP_AGENT

VM_FUNCTIONAL_CHAT_FB:
    - CHECK_EVIDENCES: [device]
    - CHECK_EVIDENCES: [chat, program, facebook]

VM_FUNCTIONAL_ADDRESSBOOK_FB:
    - CHECK_EVIDENCES: [addressbook, program, facebook]

VM_FUNCTIONAL_ADDRESSBOOK_SKYPE:
    - CHECK_EVIDENCES: [addressbook, program, skype]

SYSTEM_FUNCTIONAL_FAST:
    #- START_AGENT: 172.20.20.168
    #- CALL: SET_DEFAULTS_FUNCTIONAL
    - REPORT:
        - VM_FUNCTIONAL_CHAT_FB
        - VM_FUNCTIONAL_ADDRESSBOOK_FB

SYSTEM_FUNCTIONAL:
    #- CALL: INIT_DISPATCH
    - VM: [ funvm ]
    - REVERT
    - START_VM
    - CALL: VM_PUSH_AGENT
    - START_AGENT: 172.20.20.168
    - CALL: SET_DEFAULTS_FUNCTIONAL
    #- CROP: False
    - BUILD: [ pull, windows_elite, silent ]
    - EXECUTE_VM:
        - C:/AVTest/AVAgent/build/windows_elite/agent.exe
        - []
        - 40
        - True
        - True
    - SLEEP: 100
    - PUSH: [ AVAgent/assets/facebook.bat ]
    - EXECUTE_VM:
        - C:/AVTest/AVAgent/assets/facebook.bat
        - []
        - 40
        - True
        - True
    - SLEEP: 120
    - REPORT:
        - VM_FUNCTIONAL_CHAT_FB
        - VM_FUNCTIONAL_ADDRESSBOOK_FB
    - CALL: END_DISPATCH
