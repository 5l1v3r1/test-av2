# ---------------- TEST --------------- #

TEST_VM:
    #- VM: [360cn,adaware,ahnlab,avg,avast,avira,bitdef,comodo,drweb,emsisoft]
    #- VM: [360cn,adaware,ahnlab,avast,avast32,avg,avg32,avira,bitdef,comodo,drweb,eset,fsecure,gdata,kis,kis14,kis32,mbytes,mcafee,msessential,norman,norton,panda,risint,trendm,zoneal]
    # removed VM: [pctools,sophos,emsisoft]
    - VM: [fsecure]
    - EXECUTE_VM:
        - c:\\python27\\scripts\\easy_install.exe
        - [Pillow]
    - PUSH: [ AVAgent/assets/exec_admin.lnk, AVAgent/assets/execution.bat ]
    - EXECUTE_VM:
        - c:\\Avtest\\AVAgent\\assets\\exec_admin.lnk
        - []

TEST_CHAT:
    - CALL: INIT_DISPATCH
    #- CALL: AV_PUSH_AGENT
    - START_AGENT: 172.20.20.168
    - CALL: SET_DEFAULTS_FUNCTIONAL
    #- CROP: False
    - BUILD: [ pull, windows_elite, silent ]
    - EXECUTE_VM:
        - C:/AVTest/AVAgent/build/windows_elite/agent.exe
        - []
        - 40
        - True
        - True
    - SLEEP: 100
    - PUSH: [ AVAgent/assets/facebook.bat ]
    - EXECUTE_VM:
        - C:/AVTest/AVAgent/assets/facebook.bat
        - []
        - 40
        - True
        - True
    - SLEEP: 120
    - CHECK_EVIDENCES: [chat, program, facebook]
    - CHECK_EVIDENCES: [device]
    - CALL: END_DISPATCH

TEST_REFRESH:
    - STOP_VM
    - REFRESH_SNAPSHOT

TEST_EMPTY:
    - VM: ['noav']
    - START_AGENT
    - CHECK_EMPTY_DIR:
        - [ '/Users/avtest/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup', '/Documents and Settings/avtest/Start Menu/Programs/Startup/']
        - [ desktop.ini ]
    - STOP_AGENT

TEST_EVIDENCE:
    - VM: ['funvm']
    #- CALL: INIT_DISPATCH
    - CALL: AV_PUSH_AGENT
    - START_AGENT: 172.20.20.168
    - CALL: SET_SERVER
    - CHECK_EVIDENCES: [device]
    - CHECK_EVIDENCES: [chat,program,facebook]
    - STOP_AGENT
    - CALL: AV_GET_LOG

TEST_ELITE:
    #- VM: ['noav']
    #- CALL: AV_PUSH_AGENT
    - START_AGENT
    - CALL: BUILD_ELITE
    - STOP_AGENT

TEST_CLEAN:
    - VM: ['noav','kis']
    #- CALL: INIT_DISPATCH
    - START_AGENT
    - CALL: SET_SERVERS
    - CLEAN_EVIDENCES
    - STOP_AGENT
    #- CALL: END_DISPATCH

TEST_LOG:
    - VM: ['noav']
    #- START_VM
    - CALL: LOGOUT
    - CALL: AV_GET_LOG