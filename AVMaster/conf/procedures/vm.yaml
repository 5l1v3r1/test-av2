# -------------- VM COMMANDS -------------- #


VM_PUSH_AGENT:
    - DELETE_DIR: /AVTest/
    - DELETE_DIR: /Users/avtest/Desktop/AVTest/
    - PUSH: [ AVAgent/*.py, AVCommon/*.py, AVCommon/*.yml, AVCommon/commands/client/*.py, AVCommon/commands/meta/*.py, AVCommon/commands/*.py]
    - PUSH: [ AVAgent/assets/config*, AVAgent/assets/update_system.bat, AVAgent/assets/keyinject.exe, AVAgent/assets/meltapp.exe ]

VM_UPLOAD_SKYPE:
    - PUSH:
        - [SkypeSetup.exe]
        - updates
        - c:/Users/avtest/Desktop

VM_GET_LOG:
    - PULL:
        - ['avmonitor.log']
        - c:\\AVTest\\logs
        - logs

VM_PUSH_VIRUS:
    - CROP: True
    - PUSH: [ AVAgent/assets/vira/conficker.dll, AVAgent/assets/vira/eicar.com ]
    - SLEEP: 30
    - CHECK_STATIC: [ AVAgent/assets/vira/conficker.dll, AVAgent/assets/vira/eicar.com ]
    - SLEEP: 10
    - CROP: False
    - SCREENSHOT

VM_PULL_WINDOWS:
    - CALL: SET_DEFAULTS
    - BUILD: [ pull, windows, silent ]
    - BUILD: [ pull, windows, melt ]

VM_SCOUT:
    - CALL: SET_DEFAULTS
    - CROP: True
    - BUILD: [ scout, windows, silent ]
    - CROP: False
    - SCREENSHOT

VM_ELITE:
    - CALL: SET_DEFAULTS
    - CROP: True
    - BUILD: [ elite, windows, silent ]
    - SLEEP: 30
    - SCREENSHOT
    - CROP: False
    - UNINSTALL
    - CHECK_INFECTION
    - RELOG

VM_ELITE_FAST:
    - CALL: SET_DEFAULTS
    #- CROP: True
    - BUILD: [ scout, windows, silent ]
    - SLEEP: 30
    #- CROP: False
    - RELOG

    - CALL: SET_DEFAULTS
    - CROP: True
    - BUILD: [ elite_fast, windows, silent ]
    - CROP: False

    - ON_ERROR: CONTINUE
    - CHECK_INFECTION
    - ON_ERROR: SKIP
    - UNINSTALL

    - RELOG

VM_MELT:
    - CALL: SET_DEFAULTS
    - CROP: True
    - BUILD: [ scout, windows, melt ]
    - CROP: False
    - UNINSTALL
    - SCREENSHOT
    - RELOG


VM_STATIC_MOBILE:
    - CROP: True
    - CALL: BUILD_MOBILE
    - CROP: False

VM_STATIC:
    - CROP: True
    - ON_ERROR: CONTINUE
    - CALL: BUILD_DESKTOP
    - CALL: BUILD_MOBILE
    - CALL: BUILD_EXPLOIT
    - CROP: False
    - ON_ERROR: SKIP

VM_CLEAN_EVIDENCES:
    - CALL: SET_SERVERS
    - CLEAN_EVIDENCES

BUILD_MELT_FAST:
    - BUILD: [ pull, windows, melt ]

VM_PACKER_MELT:
    - CALL: SET_DEFAULTS
    - CROP: True
    - REPORT:
        - BUILD_MELT_FAST
        - BUILD_MELT_FAST
        - BUILD_MELT_FAST
        - BUILD_MELT_FAST
        - BUILD_MELT_FAST

        - BUILD_MELT_FAST
        - BUILD_MELT_FAST
        - BUILD_MELT_FAST
        - BUILD_MELT_FAST
        - BUILD_MELT_FAST

    - CROP: False
