__author__ = 'fabrizio'

import sys, os
sys.path.append(os.path.split(os.getcwd())[0])
sys.path.append(os.getcwd())

from AVAgent import rcs_client
from AVCommon.logger import logging
import traceback
import unittest

import socket
import time


def testEvidences():
    logging.debug('test')
    host = "rcs-minotauro"
    user = "avmonitor"
    passwd = "avmonitorp123"
    conn = rcs_client.Rcs_client(host, user, passwd)
    logging.debug(conn.login())

    target = 'VM_avtagent'
    ident = 'RCS_0000057054'
    operation_id, group_id = conn.operation('AVMonitor')
    targets = conn.targets(operation_id, target)

    # targets: [{u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386685368, u'grid_size': 459520, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c791', u'last_child': [u'52a71d114e0913e95f005b4c'], u'size': 4848}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 03:25:49 2013', u'ident': None, u'name': u'VM_norman', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b76174e0913e3e401b4d0'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c792', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'527b73f14e09132432042958'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1365687744, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c793', u'last_child': [u'5163ed5a4e0913a90f000055'], u'size': 845632}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'', u'ident': None, u'name': u'Android', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'5124ea6b4e091305b80002ac'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1365767637, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c794', u'last_child': [u'5167e2834e0913d92600b244'], u'size': 55788}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: Android Test (5)', u'ident': None, u'name': u'Android Test (5)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'5167e2834e0913d92600b241'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c795', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Mon Nov 11 17:22:52 2013', u'ident': None, u'name': u'VM_paradox', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'528104454e091334da000060'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c796', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'528f37044e0913697d01084c'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c797', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'528f34754e0913b03901073d'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c798', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'528f2d4b4e0913b0ec010632'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1381481028, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c799', u'last_child': [u'5257b5f14e09139c9a003c30'], u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'', u'ident': None, u'name': u'TestSync', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'5257b2ca4e09135221003c09'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1364381680, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c79a', u'last_child': [u'5152b2274e09131bd00016fe'], u'size': 5612}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'', u'ident': None, u'name': u'WindowsKis', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'5152ad944e09131bd00016b3'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c79b', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'52a9da034e0913ae7b00bfdd'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386688696, u'grid_size': 418384, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c79c', u'last_child': [u'52a72a144e0913ffce006493'], u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 00:24:59 2013', u'ident': None, u'name': u'VM_trendm', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b4bb54e09139e2c019160'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1365066995, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c79d', u'last_child': [u'515d44764e0913143c003106'], u'size': 130044}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: Android Test (2)', u'ident': None, u'name': u'Android Test (2)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'515d44774e0913143c003109'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c79e', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_paradox', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'5280eb694e0913fa4600ca21'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386685100, u'grid_size': 519088, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c79f', u'last_child': [u'52a71c0f4e0913cb9c005add'], u'size': 4816}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 03:15:42 2013', u'ident': None, u'name': u'VM_mbytes', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b73b84e091372f201b205'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7a0', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'la mia musica', u'ident': None, u'name': u'Mazurca', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'52a9d9ea4e0913f2e600bf88'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7a1', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'VM_win7zenoav', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'527bba8d4e091368a40429f3'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7a2', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Mon Oct 14 17:43:50 2013', u'ident': None, u'name': u'VM_emsisoft', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'525c11354e091365630017e2'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386690477, u'grid_size': 527280, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7a3', u'last_child': [u'52a731174e0913e90d006950'], u'size': 4976}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Tue Oct 01 20:31:39 2013', u'ident': None, u'name': u'VM_adaware', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b93954e0913437001d734'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386686149, u'grid_size': 595289, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7a4', u'last_child': [u'52a71ffc4e091371b0005d4e'], u'size': 6622}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 00:33:42 2013', u'ident': None, u'name': u'VM_norton', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b4dc04e09138219019227'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7a5', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'528f3c6a4e0913099f010a7a'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7a6', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'528f2c944e09130b2501052b'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386685342, u'grid_size': 588896, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7a7', u'last_child': [u'52a71d094e09139cec005b46'], u'size': 4688}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 00:35:27 2013', u'ident': None, u'name': u'VM_avira', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b4e2a4e0913e2fc0192a5'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386686116, u'grid_size': 545888, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7a8', u'last_child': [u'52a720134e0913ae7b005d55'], u'size': 12384}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 05:37:57 2013', u'ident': None, u'name': u'VM_risint', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b950e4e09130d6e01d7f7'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386650898, u'grid_size': 518912, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7a9', u'last_child': [u'52a69cf54e09137d270024ad'], u'size': 6896}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 02:39:51 2013', u'ident': None, u'name': u'VM_pctools', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b6b514e09130d6e01a6e0'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386552704, u'grid_size': 539744, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7aa', u'last_child': [u'52a4e7154e09130110022a06'], u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 00:28:56 2013', u'ident': None, u'name': u'VM_mcafee', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b4ca24e0913d1090191db'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386686119, u'grid_size': 527632, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7ab', u'last_child': [u'52a720154e09133148005d5b'], u'size': 4688}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 05:14:15 2013', u'ident': None, u'name': u'VM_kis', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b8f814e0913c2f201cc4d'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1385439566, u'grid_size': 454768, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7ac', u'last_child': [u'529421434e0913f5a50239e2'], u'size': 829}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 03:13:58 2013', u'ident': None, u'name': u'VM_zoneal', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b73504e0913a59801b1c6'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386685373, u'grid_size': 455424, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7ad', u'last_child': [u'52a71d144e09133b6b005b52'], u'size': 6864}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 00:40:19 2013', u'ident': None, u'name': u'VM_msessential', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b4f4e4e0913693f019373'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386689375, u'grid_size': 459520, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7ae', u'last_child': [u'52a72cc44e09131e32006672'], u'size': 7152}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 03:16:07 2013', u'ident': None, u'name': u'VM_ahnlab', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b73d14e0913b91001b239'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386685333, u'grid_size': 459520, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7af', u'last_child': [u'52a71cef4e091329f5005b40'], u'size': 5104}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 00:37:36 2013', u'ident': None, u'name': u'VM_avast', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b4eab4e091344d001930f'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386686363, u'grid_size': 419904, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7b0', u'last_child': [u'52a720f94e091397ca005dd8'], u'size': 6896}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 17:41:39 2013', u'ident': None, u'name': u'VM_eset', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524c3eab4e0913a165002d1f'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7b1', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'527bd63c4e091353fc04341c'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386688069, u'grid_size': 634480, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7b2', u'last_child': [u'52a727ec4e091332b30061bb'], u'size': 7152}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 00:27:31 2013', u'ident': None, u'name': u'VM_panda', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b4c4d4e09134370019188'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386688682, u'grid_size': 519088, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7b3', u'last_child': [u'52a72a094e0913103900648c'], u'size': 4432}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 10:29:25 2013', u'ident': None, u'name': u'VM_fsecure', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524bd95e4e0913c2f2020f44'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1372671886, u'grid_size': 12686768, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7b4', u'last_child': [u'51d1354d4e09135b6500e38e'], u'size': 143120}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: Windows Chrome (1)', u'ident': None, u'name': u'Windows Chrome (1)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'51d1354c4e09135b6500e389'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386693926, u'grid_size': 131776, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7b5', u'last_child': [u'52a71f3d4e0913f039005ce6'], u'size': 3616}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Tue Oct 01 20:37:27 2013', u'ident': None, u'name': u'VM_360cn', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b94f14e0913d5eb01d7ab'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7b6', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'528f281b4e09137091010428'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386784150, u'grid_size': 104993, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7b7', u'last_child': [u'52a89eeb4e0913bae300b790'], u'size': 2664}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Fri Nov 15 15:42:34 2013', u'ident': None, u'name': u'VM_Win7-NoAV', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'528632b74e0913564a009c8c'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7b8', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'527bd6884e09132cb1043549'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1377771153, u'grid_size': 10139, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7b9', u'last_child': [u'521f1d404e0913229f000263'], u'size': 7249}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: Test Skype (1)', u'ident': None, u'name': u'Test Skype (1)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'521f1d3f4e0913229f00025e'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1380881141, u'grid_size': 17235, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7ba', u'last_child': [u'524e8b994e0913581d000255'], u'size': 12676}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: Test Upgrade (1)', u'ident': None, u'name': u'Test Upgrade (1)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524e8b984e0913581d000250'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1381923487, u'grid_size': 764960, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7bb', u'last_child': [u'525e78834e09133120005073'], u'size': 18323}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: Test FileSystem (1)', u'ident': None, u'name': u'Test FileSystem (1)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'525e78824e0913312000506e'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1370991538, u'grid_size': 1940232, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7bc', u'last_child': [u'51b735684e0913a1400002bb'], u'size': 56224}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: test AZNS (1)', u'ident': None, u'name': u'test AZNS (1)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'51b735684e0913a1400002b6'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1365075746, u'grid_size': 4672, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7bd', u'last_child': [u'515d3d0e4e0913143c00303e'], u'size': 45464}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: BB SMS Action (1)', u'ident': None, u'name': u'BB SMS Action (1)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'515d3d0e4e0913143c003041'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1365067049, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7be', u'last_child': [u'515d44744e0913143c0030ff'], u'size': 51752}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: Android Test (1)', u'ident': None, u'name': u'Android Test (1)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'515d44744e0913143c003102'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7bf', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'528f38ca4e09138b9401095f'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386665650, u'grid_size': 670464, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7c0', u'last_child': [u'52a6d6954e0913cb9c004797'], u'size': 5824}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 07:15:53 2013', u'ident': None, u'name': u'VM_kis14', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524bac034e0913943101f5fe'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386693305, u'grid_size': 88592, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7c1', u'last_child': [u'52a72ac84e09138acd0064ac'], u'size': 3008}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 02:48:17 2013', u'ident': None, u'name': u'VM_bitdef', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b6d4c4e0913e9a201a7b4'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386650680, u'grid_size': 178880, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7c2', u'last_child': [u'52a69c1a4e091322ae002445'], u'size': 9024}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 03:13:37 2013', u'ident': None, u'name': u'VM_sophos', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b733b4e0913e2af01b18e'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1380627656, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7c3', u'last_child': [u'524bd5d74e09139e2c020e88'], u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: TestSimpleExpl (2)', u'ident': None, u'name': u'TestSimpleExpl (2)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524bd5d64e09139e2c020e83'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1372854461, u'grid_size': 431395, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7c4', u'last_child': [u'51d417cf4e091336e8002ff2'], u'size': 6061}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: Test Chrome (2)', u'ident': None, u'name': u'Test Chrome (2)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'51d417ce4e091336e8002fec'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': None, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7c5', u'last_child': None, u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'Dammy', u'ident': None, u'name': u'TEST_VM_Zanzara.local', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'528f3e5a4e091392fa010b95'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1385995759, u'grid_size': 214224, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7c6', u'last_child': [u'529c7c8b4e09137b9a0008dc'], u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 00:27:53 2013', u'ident': None, u'name': u'VM_gdata', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b4c644e091354c10191b1'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386693699, u'grid_size': 2739232, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7c7', u'last_child': [u'52a72ca84e0913fc4200666a'], u'size': 4256}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 05:34:42 2013', u'ident': None, u'name': u'VM_avg32', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b944b4e0913576c01d76f'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386694411, u'grid_size': 427216, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7c8', u'last_child': [u'52a71b4d4e091332b3005932'], u'size': 5616}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Thu Oct 03 03:59:54 2013', u'ident': None, u'name': u'VM_avast32', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524ccf914e091331f200b2d7'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1385962275, u'grid_size': 160448, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7c9', u'last_child': [u'529c1b174e0913c08900f18c'], u'size': 5632}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 05:01:04 2013', u'ident': None, u'name': u'VM_drweb', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b8c694e0913b07701cac7'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386653355, u'grid_size': 40464, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7ca', u'last_child': [u'52a6a68e4e091367c7002977'], u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 04:53:20 2013', u'ident': None, u'name': u'VM_comodo', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b8a9a4e0913693f01c824'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386693939, u'grid_size': 900720, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7cb', u'last_child': [u'52a7288f4e0913db6e006369'], u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Oct 02 03:34:13 2013', u'ident': None, u'name': u'VM_avg', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524b780f4e0913acab01b605'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386693833, u'grid_size': 143712, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7cc', u'last_child': [u'52a72d224e0913ee9200668c'], u'size': 4128}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Thu Oct 03 03:49:07 2013', u'ident': None, u'name': u'VM_kis32', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'524ccd0a4e09135b4600a7cf'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1365762267, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7cd', u'last_child': [u'5167dccf4e0913d3e40099ad'], u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: Android Test (4)', u'ident': None, u'name': u'Android Test (4)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'5167dcce4e0913d3e40099aa'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1365760833, u'grid_size': 0, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7ce', u'last_child': [u'5167daaf4e09132cc5008174'], u'size': 0}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: Android Test (3)', u'ident': None, u'name': u'Android Test (3)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'5167daaf4e09132cc5008171'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1364298813, u'grid_size': 881452, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7cf', u'last_child': [u'5139b4404e091305c8000035'], u'size': 92096}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: DVD_Offline (1)', u'ident': None, u'name': u'DVD_Offline (1)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'5139b4404e091305c8000038'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1372859825, u'grid_size': 1665166, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7d0', u'last_child': [u'51d4198f4e09132a0f0036a0'], u'size': 57296}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'5124ea664e091305b80002a8'], u'desc': u'Created automatically on first sync from: Test Chrome (1)', u'ident': None, u'name': u'Test Chrome (1)', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'51d1569d4e09135d3f00e5fa'}, {u'demo': None, u'updated_at': None, u'seed': None, u'cs': None, u'instance': None, u'platform': None, u'version': None, u'logkey': None, u'uninstalled': None, u'type': None, u'status': u'open', u'stat': {u'last_sync': 1386874247, u'grid_size': 183088, u'last_sync_status': None, u'user': None, u'evidence': {}, u'source': None, u'dashboard': {}, u'device': None, u'_id': u'52aa1b0d4e0913fc4200c7d1', u'last_child': [u'52aa04d14e0913a56300c604'], u'size': 34599}, u'good': None, u'deleted': None, u'_kind': u'target', u'upgradable': None, u'user_ids': [], u'scout': None, u'path': [u'51224a314e091305b800005d'], u'desc': u'made by vmavtest at Wed Dec 11 17:42:21 2013', u'ident': None, u'name': u'VM_avtagent', u'confkey': None, u'created_at': None, u'counter': None, u'purge': None, u'contact': None, u'group_ids': [], u'_id': u'52a895cc4e0913f2e600b406'}]

    for target_id in targets:
        logging.debug("target_id: %s" % target_id)
        factories = conn.factories(target_id)
        logging.debug("  factories: %s" % factories)
        #for fac in [a for a,i in factories if i == ident]:
        #    logging.debug("  factories: %s" % fac)

    instances = conn.instances_by_name("avtagent")
    logging.debug('instances: %s' % instances)

    instance = instances[0]
    instance_id = instance['_id']
    target_id = instance['path'][1]


    evidences =   conn.evidences(target_id, instance_id, "type", "chat")
    evidences_d = conn.evidences(target_id, instance_id, "type", "device")
    evidences_a = conn.evidences(target_id, instance_id, "type", "addressbook")
    evidences_w =   conn.evidences(target_id, instance_id, "type", "")
    evidences_all = conn.evidences(target_id, instance_id)
    evidences_f =   conn.evidences(target_id, instance_id, "aid", instance_id)

    prog = "skype"
    for ev in evidences_a:
        #content = ev['data']['content']
        program = ev['data']['program']
        logging.debug("got evidence: %s: %s" %(program, ev))
        if prog == program:
            logging.info("GOT IT!")
            break

    conn.logout()

def testMelt():
    logging.debug('test')
    host = "rcs-minotauro"
    user = "avmonitor"
    passwd = "avmonitorp123"
    conn = rcs_client.Rcs_client(host, user, passwd)
    logging.debug(conn.login())

    if(False):
        operation, target, factory = '51222810aef1de0f040003f9', '51222b77aef1de0f040005d0', '51222b79aef1de0f040005d4'
        config = open('assets/config.json').read()
        conn.factory_add_config(factory, config)

    else:
        operation = conn.operation('AVMonitor')
        targets = conn.targets(operation, "Mazurca")

        for t in targets:
            logging.debug("delete target: ", t)
            conn.target_delete(t)

        logging.debug("remained targets: ", conn.targets(operation, "Mazurca"))

        target = conn.target_create(operation, 'Mazurca', 'la mia musica')
        factory = conn.factory_create(
            operation, target, 'desktop', 'Bella fattoria', 'degli animali')
        logging.debug("factory: ", factory)
        # sleep(10)

        config = open('assets/config.json').read()
        conn.factory_add_config(factory, config)

        logging.debug("targets: ", targets)

    param = {'platform': 'windows',
             'binary': {'demo': False, 'admin': False},
             'melt': {'scout': True, 'admin': False, 'bit64': True, 'codec': True},
             'sign': {}
             }

    #{"admin"=>false, "bit64"=>true, "codec"=>true, "scout"=>true}
    try:
        #r = conn.build(factory, param, 'build.out')
        logging.debug("build")
        r = conn.build_melt(factory, param, 'assets/meltapp.exe', 'build.out')

    except Exception, e:
        logging.debug("DBG trace %s" % traceback.format_exc())
        logging.debug(e)

    r = conn.enum_instances(factory)
    logging.debug("instances: ", r)

    # sleep(5)
    conn.target_delete(target)
    logging.debug("'%s','%s','%s' " % (operation, target, factory))
    logging.debug(conn.logout())

class TestRcsClient(unittest.TestCase):

    def setUp(self):
        pass

    def test_connection(self):
        logging.debug('test')
        host = "rcs-minotauro"
        user = "avmonitor"
        passwd = "avmonitorp123"
        conn = rcs_client.Rcs_client(host, user, passwd)
        self.assertTrue(conn.login())

        status = conn.server_status()
        logging.debug(status)

        self.assertIsInstance(status, dict)
        self.assertEqual(len(status), 3)

        hostname = socket.gethostname()
        logging.debug("%s %s\n" % (hostname, time.ctime()))
        target = 'TEST_VM_%s' % hostname

        #operation_id, group_id = conn.operation()

        operation_id, group_id = conn.operation('AVMonitor')
        logging.debug("operation_id AVMonitor: %s" % operation_id)
        logging.debug("group_id AVMonitor: %s" % group_id)
        self.assertIsInstance(group_id, basestring)
        self.assertEqual(len(group_id), 24)

        privs = [
            'ADMIN', 'ADMIN_USERS', 'ADMIN_OPERATIONS', 'ADMIN_TARGETS', 'ADMIN_AUDIT', 'ADMIN_LICENSE', 'SYS', 'SYS_FRONTEND', 'SYS_BACKEND', 'SYS_BACKUP', 'SYS_INJECTORS', 'SYS_CONNECTORS', 'TECH',
            'TECH_FACTORIES', 'TECH_BUILD', 'TECH_CONFIG', 'TECH_EXEC', 'TECH_UPLOAD', 'TECH_IMPORT', 'TECH_NI_RULES', 'VIEW', 'VIEW_ALERTS', 'VIEW_FILESYSTEM', 'VIEW_EDIT', 'VIEW_DELETE', 'VIEW_EXPORT', 'VIEW_PROFILES']

        user_id = conn.user_create("avmonitor_zeno", passwd, privs, group_id)
        self.assertTrue(user_id)
        user = "avmonitor_zeno"
        logging.debug("user_id:  %s" % user_id)
        conn.logout()

        # login with new user
        conn = rcs_client.Rcs_client(host, user, passwd)
        login = conn.login()
        logging.debug("login: %s" % login)
        self.assertIsNotNone(login)
        t_id = conn.target_create(operation_id, target, "Dammy")
        logging.debug("t_id:  %s" % t_id)
        self.assertIsInstance(t_id, basestring)
        self.assertEqual(len(t_id), 24)

        targets = conn.targets(operation_id)
        self.assertGreater(len(targets), 1)

        logging.debug("targets:  %s" % targets)
        all_factories = conn.all_factories()

        for target_id in targets:
            logging.debug("target:  %s" % target_id)

            factories = conn.factories(target_id, all_factories)
            logging.debug("factories:  %s" % factories)

            #self.assertEqual(factories, [])

            for factory_id, ident in factories:
                logging.debug("factory_id  %s" % factory_id)
                instances = conn.instances(ident)
                logging.debug("instances:  %s" % instances)


                for instance_id in instances:
                    evidences = conn.evidences(target_id, instance_id)
                    devices = conn.evidences(target_id, instance_id, "type", "device")
                    continue

                    logging.debug("info %s" % instance_id)
                    info = conn.instance_info(instance_id)
                    logging.debug(info)
                    assert info['scout'] is True

                    logging.debug("upgrade elite")
                    res = conn.instance_upgrade(instance_id)
                    logging.debug("res: %s" % res)

                    info = conn.instance_info(instance_id)
                    logging.debug(info)
                    if res:
                        assert info['upgradable'] is True

    def testCreateFactory(self):
        logging.debug('test')
        host = "rcs-minotauro"
        user = "avmonitor"
        passwd = "avmonitorp123"

        conn = rcs_client.Rcs_client(host, user, passwd)
        logging.debug("login: %s" % conn.login())

        operation_id, group_id = conn.operation('AVMonitor')

        logging.debug("operation_id AVMonitor: %s" % operation_id)
        logging.debug("group_id AVMonitor: %s" % group_id)

        targets = conn.targets(operation_id, "Mazurca")


        for t in targets:
            logging.debug("delete target: %s" % t)
            conn.target_delete(t)

        targets = conn.targets(operation_id, "Mazurca")
        logging.debug("remained targets: %s" % targets)
        self.assertEqual(len(targets), 0)

        target = conn.target_create(operation_id, 'Mazurca', 'la mia musica')
        factory_id, factory_ident = conn.factory_create(
            operation_id, target, 'desktop', 'Bella fattoria', 'degli animali')
        logging.debug("factory: %s" % factory_id)
        # sleep(10)
        self.assertIsNotNone(factory_id)
        config = open('../AVAgent/assets/config_desktop.json').read()
        conn.factory_add_config(factory_id, config)

        targets = conn.targets(operation_id, "Mazurca")
        self.assertEqual(len(targets), 1)
        self.assertEqual(targets[0], target)

        ret = conn.factories(targets[0])
        logging.debug("factory: %s" % ret)

        self.assertEqual(len(ret), 1)
        self.assertEqual(ret[0][0], factory_id)
        self.assertEqual(ret[0][1], factory_ident)
        #

if __name__ == "__main__":

    #unittest.main()
    testEvidences()